# 认识bash

Bash是一种特殊的shell, 所谓shell,是用户使用命令行与系统进行沟通的系统沟通的介质。有了图形界面，为什还要用shell? 

- 大家都一样。不同发行版本的图形界面操作大不相同，单时shell命令都一样。
- 速度快。大多服务器版都没有提供图形界面。原因就是图形界面浪费资源。
- 学习shell,还可以自己编写shell脚本，更自如的管理系统。

shell依据发展者的不同有很多不同的版本，比如：sh(Bourne SHell)、C SHELL、K SHELL、TCSH。当然还有linux使用的版本 Bash (Bourne Again SHell)。

我们可以查看 /etc/shells文件，来了解我们系统可以使用的shell。

```
$ cat /etc/shells
# /etc/shells: valid login shells
/bin/sh
/bin/dash
/bin/bash
/bin/rbash
```

虽然各家的shell都差不多，但是语法表达上还是有所不同。我们重点来学习linux下常用的bash。

 **特性**

1. 命令记忆。可以通过上下箭头键查找历史命令，这些命令记录在用户主目录的.bash_history档案中。
2. 命令补全。可以按tab键来补全命令。
3. 别名设置。通过alias命令来设置命令的别名，如：`alias lm='ls -al'` 以后，当你执行lm时，就相当与执行了 `ls-al`命令
4. 程序化脚本。
5. 支持万用符。如执行`ls -l ~/X*`将列出家目录下所有以X开头的文件或X开头的目录下的所有文件。

**技巧**

* 命令换行输入。默认的按下enter建是执行命令，要实现换行要借助脱逃字符\,在\后紧跟enter，则为换行。
* `Ctrl+u  `从光标处向前删除命令；`ctrl+u`光标处向后删除命令；`ctrl+a`光标移动到最前；`ctrl+e`光标移动到左后。

# 变量功能

常见的变量分为 **普通变量**、**环境变量**以及**接口变量**三种。普通变量的作用域是当前程序；环境变量的作用域是整个系统，在任何程序中都能访问。环境变量又分**系统环境变量**和**自定义环境**变量，为了区分，系统环境变量通常大写。

**变量的取用、设置与销毁**

- 变量的取用。使用\$变量名或者 \${变量名}来取得变量的值。比如要PATH变量的值可用 `echo  $PATH` 来实现。

- 变量的设置：

  1. 在命令行或脚本中手动赋值：

      * 变量与变量的值以=号来链接，如`myvar=测试`.注意变量明前没有$；
      * =两边不能有空格;
      * 变量值中如果有空格，需要使用单引号或双引号隔开括起来。双引号内可以用$
      * 读取变量的值，单引号内则不能;可以用反单引号\`指令\`或\$(指令)，将指令的执行结果，复制给变量。如` version="你的系统版本为：$(uname -r)"` ;
      * export来将变量声明为环境变量，这样就可以在其他程序中引用该变量。

  2. 使用 read接收键盘的输入，为变量赋值。

     ```
     [dmtsai@study ~]$ read [-pt] variable
     选项与参数:
     -p :后面可以接提示字符!
     -t :后面可以接等待的“秒数!”这个比较有趣~不会一直等待使用者啦!
     范例一:让使用者由键盘输入一内容,将该内容变成名为 atest 的变量
     [dmtsai@study ~]$ read atest
     This is a test
     &lt;==此时光标会等待你输入!请输入左侧文字看看
     [dmtsai@study ~]$ echo ${atest}
     This is a test
     &lt;==你刚刚输入的数据已经变成一个变量内容!
     范例二:提示使用者 30 秒内输入自己的大名,将该输入字串作为名为 named 的变量内容
     [dmtsai@study ~]$ read -p "Please keyin your name: " -t 30 named
     Please keyin your name: VBird Tsai
     &lt;==注意看,会有提示字符喔!
     [dmtsai@study ~]$ echo ${named}
     VBird Tsai
     &lt;==输入的数据又变成一个变量的内容了!
     ```

- 变量类型

   三种类型：字符串，数字和数组  

  变量的默认类型为字符型，如下运算：

  ```
  zhangle@zhangle-computer:~$ sum=1+2+3
  zhangle@zhangle-computer:~$ echo $sum
  1+2+3
  ```

  要想进行数字运算，则必须要把变量宣告为数字，需要借助 declare或typset命令。

  ```
  $ declare [-aixr] variable
  选项与参数:
  -a :将后面名为 variable 的变量定义成为阵列 (array) 类型
  -i :将后面名为 variable 的变量定义成为整数数字 (integer) 类型
  -x :用法与 export 一样,就是将后面的 variable 变成环境变量;
  -r :将变量设置成为 readonly 类型,该变量不可被更改内容,也不能 unset
  ```

  将上面代码改为：

  ```
  zhangle@zhangle-computer:~$ declare -i sum=1+2+3
  zhangle@zhangle-computer:~$ echo $sum
  6
  ```

  **数组** 

  定义：var[index]=value；例如：

  ```
  zhangle@zhangle-computer:$ var[1]="small min"
  zhangle@zhangle-computer:$ var[2]="big min"
  zhangle@zhangle-computer:$ var[3]="nice min"
  zhangle@zhangle-computer:$ echo "${var[1]}, ${var[2]}, ${var[3]}"
  small min, big min, nice min
  ```

  ​

- 变量的销毁。使用unset 变量名，如`unset myvar`;

**环境变量**

常见的系统环境变量

* PATH bash会按该变量记录的路径顺序来搜寻指令。
* HOME  记录了当前登录用户家目录的位置。
* SHELL 当前shell程序的位置
* LANG 当前的语系
* RANDOM 随机数，我们可以使用$RANDOM来取得一个随机数。

可以使用`env`观察环境变量；可以使用`locale`来查看语系变量，这些语系变量决定了系统所用的语系，在/etc/locale.conf文件中为这些变量赋予初始值。

**接口变量**

* **PS1** 命令提示符变量。可以通过该变量的值来设置命令提示符的样式。我当前的命令提示符是这样子的`zhangle@zhangle-computer:~$`,看一下PS!的值：

  ```
  zhangle@zhangle-computer:~$ echo $PS1
  \[\e]0;\u@\h: \w\a\]${debian_chroot:+($debian_chroot)}\u@\h:\w\$
  ```

  PS1变量值中符号的意义如下：

  \d :可显示出“星期 月 日”的日期格式,如:"Mon Feb 2"
  \H :完整的主机名称。举例来说,鸟哥的练习机为“study.centos.vbird”
  \h :仅取主机名称在第一个小数点之前的名字,如鸟哥主机则为“study”后面省略
  \t :显示时间,为 24 小时格式的“HH:MM:SS”
  \T :显示时间,为 12 小时格式的“HH:MM:SS”
  \A :显示时间,为 24 小时格式的“HH:MM”
  \@ :显示时间,为 12 小时格式的“am/pm”样式
  \u :目前使用者的帐号名称,如“dmtsai”;
  \v :BASH 的版本信息,如鸟哥的测试主机版本为 4.2.46(1)-release,仅取“4.2”显示
  \w :完整的工作目录名称,由根目录写起的目录名称。但主文件夹会以 ~ 取代;
  \W :利用 basename 函数取得工作目录名称,所以仅会列出最后一个目录名。

  \#:下达的第几个指令。

  \$ :提示字符,如果是 root 时,提示字符为 # ,否则就是 $ 啰~

* **\$** 当前shell的PID。\$本身也是一个变量，可以通过`echo $$` 来查看当前shell的PID。

* **?** 变量存放者执行的上个指令的回传值。

* **OSTYPE, HOSTTYPE, MACHTYPE**:(主机硬件与核心的等级)

可以使用`set`来观察所有的变量。

